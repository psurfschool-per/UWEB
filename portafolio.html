<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Portafolio de tuweb - Casos de √©xito en desarrollo web. Proyectos de sitios web, aplicaciones web y e-commerce realizados en Per√∫. Testimonios reales de clientes satisfechos.">
    <meta name="keywords" content="portafolio desarrollo web, casos √©xito web, proyectos web Per√∫, ejemplos sitios web, trabajos desarrollo web, referencias web">
    <meta name="author" content="tuweb - Desarrollo Web Profesional">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Spanish">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Portafolio - tuweb | Casos de √âxito en Desarrollo Web">
    <meta property="og:description" content="Descubre nuestros proyectos destacados y casos de √©xito. Sitios web, aplicaciones y e-commerce desarrollados con calidad profesional.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tuweb.pe/portafolio.html">
    <meta property="og:image" content="https://tuweb.pe/assets/images/og-portafolio.jpg">
    <meta property="og:image:alt" content="Portafolio de proyectos tuweb">
    <meta property="og:site_name" content="tuweb">
    <meta property="og:locale" content="es_PE">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Portafolio - tuweb | Casos de √âxito">
    <meta name="twitter:description" content="Descubre nuestros proyectos destacados y casos de √©xito en desarrollo web profesional.">
    <meta name="twitter:image" content="https://tuweb.pe/assets/images/og-portafolio.jpg">
    
    <title>Portafolio - tuweb | Casos de √âxito en Desarrollo Web</title>
    <link rel="canonical" href="https://tuweb.pe/portafolio.html">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="global.css" as="style">
    <link rel="preload" href="script.js" as="script">
    <link rel="preload" href="assets/data/projects.json" as="fetch" crossorigin="anonymous">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    
    <link rel="stylesheet" href="global.css">
</head>
<body>
    <!-- Navbar Component -->
    <div id="navbar-container"></div>

    <!-- Portfolio Hero -->
    <section class="page-header">
        <div class="container">
            <h1 class="page-header__title">Nuestro Portafolio</h1>
            <p class="page-header__description">
                Descubre algunos de nuestros proyectos m√°s destacados y casos de √©xito
            </p>
        </div>
    </section>

    <!-- Portfolio Filters -->
    <section style="padding: 60px 0 40px; background: var(--bg-light);">
        <div class="container">
            <div class="portfolio-filters">
                <button class="filter-btn active" data-filter="all">Todos</button>
                <button class="filter-btn" data-filter="web">Sitios Web</button>
                <button class="filter-btn" data-filter="app">Aplicaciones</button>
                <button class="filter-btn" data-filter="ecommerce">E-commerce</button>
            </div>
        </div>
    </section>

    <!-- Portfolio Grid -->
    <section style="padding: 0 0 80px; background: var(--bg-light);">
        <div class="container">
            <div class="portfolio-grid" id="portfolio-grid">
                <!-- Los proyectos se cargar√°n din√°micamente desde projects.json -->
            </div>
        </div>
    </section>

    <!-- Portfolio Modal -->
    <div class="modal" id="portfolio-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <div class="modal-body" id="modal-body">
                <!-- El contenido del modal se cargar√° din√°micamente -->
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <section class="pricing-cta">
        <div class="container">
            <div class="pricing-cta__content">
                <h2 class="pricing-cta__title">¬øTe gusta lo que ves?</h2>
                <p class="pricing-cta__description">
                    Trabajemos juntos en tu pr√≥ximo proyecto. Cont√°ctanos para una consulta gratuita.
                </p>
                <a href="contacto.html" class="btn btn--primary btn--large">Iniciar Proyecto</a>
            </div>
        </div>
    </section>

    <!-- Footer Component -->
    <div id="footer-container"></div>

    <!-- Component Loader -->
    <script src="components/load-components.js"></script>
    <script src="assets/images/lazy-load-enhanced.js"></script>
    <script src="script.js"></script>
    <script>
        // Cargar y mostrar proyectos del portafolio
        async function loadPortfolio() {
            try {
                const response = await fetch('assets/data/projects.json');
                const data = await response.json();
                const portfolioGrid = document.getElementById('portfolio-grid');
                
                data.projects.forEach(project => {
                    const projectElement = document.createElement('div');
                    projectElement.className = `portfolio-item ${project.category}`;
                    projectElement.innerHTML = `
                        <div class="portfolio-image">
                            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjI1MCIgdmlld0JveD0iMCAwIDQwMCAyNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9IjIwMCIgY3k9IjEyNSIgcj0iMjAiIGZpbGw9IiM5Q0EzQUYiLz4KPHA+Q2FyZ2FuZG8uLi48L3A+Cjwvc3ZnPg==" 
                                 data-src="${project.image}" 
                                 data-webp="${project.image.replace('.jpg', '.webp')}"
                                 data-avif="${project.image.replace('.jpg', '.avif')}"
                                 alt="${project.title}" 
                                 class="lazy-image performance-optimized"
                                 loading="lazy"
                                 decoding="async">
                            <div class="portfolio-overlay">
                                <div class="portfolio-overlay-content">
                                    <h3>Ver Proyecto</h3>
                                    <p>M√°s detalles</p>
                                </div>
                            </div>
                        </div>
                        <div class="portfolio-content">
                            <div class="portfolio-category">${getCategoryName(project.category)}</div>
                            <h3 class="portfolio-title">${project.title}</h3>
                            <p class="portfolio-description">${project.description.substring(0, 100)}...</p>
                        </div>
                    `;
                    
                    projectElement.addEventListener('click', () => openModal(project));
                    portfolioGrid.appendChild(projectElement);
                });
                
                // Configurar filtros
                setupFilters();
                
                // Inicializar lazy loading
                initLazyLoading();
                
                // Trigger custom event for enhanced lazy loading
                document.dispatchEvent(new CustomEvent('portfolioLoaded'));
                
                // Restaurar filtro guardado o usar 'all' por defecto
                const savedFilter = localStorage.getItem('portfolio_filter') || 'all';
                const savedFilterBtn = document.querySelector(`[data-filter="${savedFilter}"]`);
                
                if (savedFilterBtn) {
                    // Simular clic en el filtro guardado
                    setTimeout(() => {
                        handleFilterChange(savedFilterBtn);
                    }, 100);
                } else {
                    // Inicializar contador de proyectos
                    updateProjectCount('all');
                }
                
            } catch (error) {
                console.error('Error loading portfolio:', error);
                document.getElementById('portfolio-grid').innerHTML = '<p>Error al cargar el portafolio</p>';
            }
        }
        
        function getCategoryName(category) {
            const categories = {
                'web': 'Sitio Web',
                'app': 'Aplicaci√≥n',
                'ecommerce': 'E-commerce'
            };
            return categories[category] || category;
        }
        
        function setupFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            
            filterBtns.forEach((btn, index) => {
                // Click handler
                btn.addEventListener('click', () => {
                    handleFilterChange(btn);
                });
                
                // Keyboard navigation
                btn.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        handleFilterChange(btn);
                    } else if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                        e.preventDefault();
                        const direction = e.key === 'ArrowLeft' ? -1 : 1;
                        const nextIndex = (index + direction + filterBtns.length) % filterBtns.length;
                        filterBtns[nextIndex].focus();
                    }
                });
                
                // Accessibility attributes
                btn.setAttribute('role', 'button');
                btn.setAttribute('tabindex', '0');
                btn.setAttribute('aria-pressed', btn.classList.contains('active'));
            });
        }
        
        function handleFilterChange(activeBtn) {
            const filterBtns = document.querySelectorAll('.filter-btn');
            const filtersContainer = document.querySelector('.portfolio-filters');
            
            // Prevenir m√∫ltiples clics durante la animaci√≥n
            if (filtersContainer.classList.contains('loading')) return;
            
            // Actualizar bot√≥n activo
            filterBtns.forEach(b => {
                b.classList.remove('active');
                b.setAttribute('aria-pressed', 'false');
            });
            activeBtn.classList.add('active');
            activeBtn.setAttribute('aria-pressed', 'true');
            
            // A√±adir estado de carga
            filtersContainer.classList.add('loading');
            
            const filter = activeBtn.dataset.filter;
            
            // Guardar filtro seleccionado
            localStorage.setItem('portfolio_filter', filter);
            
            filterProjects(filter);
            
            // Remover estado de carga despu√©s de la animaci√≥n
            setTimeout(() => {
                filtersContainer.classList.remove('loading');
            }, 600);
        }
        
        function filterProjects(filter) {
            const portfolioItems = document.querySelectorAll('.portfolio-item');
            const portfolioGrid = document.getElementById('portfolio-grid');
            
            // A√±adir clase de transici√≥n al grid
            portfolioGrid.style.opacity = '0.7';
            portfolioGrid.style.transform = 'scale(0.98)';
            
            setTimeout(() => {
                portfolioItems.forEach((item, index) => {
                    const shouldShow = filter === 'all' || item.classList.contains(filter);
                    
                    if (shouldShow) {
                        item.style.display = 'block';
                        item.style.opacity = '0';
                        item.style.transform = 'translateY(20px) scale(0.9)';
                        
                        // Animaci√≥n escalonada
                        setTimeout(() => {
                            item.style.transition = 'all 0.4s ease';
                            item.style.opacity = '1';
                            item.style.transform = 'translateY(0) scale(1)';
                        }, index * 50);
                    } else {
                        item.style.transition = 'all 0.3s ease';
                        item.style.opacity = '0';
                        item.style.transform = 'translateY(-20px) scale(0.9)';
                        
                        setTimeout(() => {
                            item.style.display = 'none';
                        }, 300);
                    }
                });
                
                // Restaurar el grid
                setTimeout(() => {
                    portfolioGrid.style.transition = 'all 0.3s ease';
                    portfolioGrid.style.opacity = '1';
                    portfolioGrid.style.transform = 'scale(1)';
                }, 200);
                
            }, 100);
            
            // Actualizar contador de proyectos
            updateProjectCount(filter);
        }
        
        function updateProjectCount(filter) {
            const portfolioItems = document.querySelectorAll('.portfolio-item');
            let visibleCount = 0;
            
            portfolioItems.forEach(item => {
                if (filter === 'all' || item.classList.contains(filter)) {
                    visibleCount++;
                }
            });
            
            // Actualizar o crear contador
            let counter = document.querySelector('.portfolio-counter');
            if (!counter) {
                counter = document.createElement('div');
                counter.className = 'portfolio-counter';
                const filtersContainer = document.querySelector('.portfolio-filters').parentNode;
                filtersContainer.appendChild(counter);
            }
            
            const totalCount = portfolioItems.length;
            const filterName = getFilterDisplayName(filter);
            
            if (visibleCount === 0) {
                counter.innerHTML = `
                    <div style="text-align: center; padding: 2rem; background: white; border-radius: 12px; box-shadow: var(--shadow);">
                        <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">üîç</div>
                        <h3 style="color: var(--text-color); margin-bottom: 0.5rem;">No se encontraron proyectos</h3>
                        <p style="color: var(--text-light); margin: 0;">
                            No hay proyectos disponibles en la categor√≠a <strong>${filterName}</strong>.
                            <br>Prueba con otra categor√≠a o ve todos los proyectos.
                        </p>
                        <button onclick="document.querySelector('[data-filter=\\"all\\"]').click()" 
                                style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; transition: var(--transition);"
                                onmouseover="this.style.background='var(--primary-dark)'"
                                onmouseout="this.style.background='var(--primary-color)'">
                            Ver todos los proyectos
                        </button>
                    </div>
                `;
            } else {
                counter.innerHTML = `
                    <p style="text-align: center; color: var(--text-light); margin: 0; font-size: 0.95rem;">
                        Mostrando <strong style="color: var(--primary-color);">${visibleCount}</strong> 
                        ${visibleCount === 1 ? 'proyecto' : 'proyectos'} 
                        ${filter !== 'all' ? `de <strong>${filterName}</strong>` : 'en total'}
                        ${filter !== 'all' ? `<span style="margin-left: 1rem; opacity: 0.7;">(${totalCount} total)</span>` : ''}
                    </p>
                `;
            }
        }
        
        function getFilterDisplayName(filter) {
            const filterNames = {
                'all': 'Todos',
                'web': 'Sitios Web',
                'app': 'Aplicaciones',
                'ecommerce': 'E-commerce'
            };
            return filterNames[filter] || filter;
        }
        
        // Funci√≥n para inicializar lazy loading
        function initLazyLoading() {
            const lazyImages = document.querySelectorAll('.lazy-image');
            
            // Verificar si el navegador soporta Intersection Observer
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            const src = img.getAttribute('data-src');
                            
                            if (src) {
                                // Crear una nueva imagen para precargar
                                const newImg = new Image();
                                newImg.onload = () => {
                                    // Una vez cargada, actualizar el src y a√±adir clase loaded
                                    img.src = src;
                                    img.classList.add('loaded');
                                    img.removeAttribute('data-src');
                                };
                                newImg.onerror = () => {
                                    // Si falla la carga, mantener placeholder
                                    img.classList.add('error');
                                };
                                newImg.src = src;
                            }
                            
                            observer.unobserve(img);
                        }
                    });
                }, {
                    rootMargin: '50px 0px',
                    threshold: 0.1
                });
                
                lazyImages.forEach(img => imageObserver.observe(img));
            } else {
                // Fallback para navegadores que no soportan Intersection Observer
                lazyImages.forEach(img => {
                    const src = img.getAttribute('data-src');
                    if (src) {
                        img.src = src;
                        img.classList.add('loaded');
                        img.removeAttribute('data-src');
                    }
                });
            }
        }
        
        function openModal(project) {
            const modal = document.getElementById('portfolio-modal');
            const modalBody = document.getElementById('modal-body');
            
            // Crear galer√≠a de im√°genes
            const galleryImages = project.gallery && project.gallery.length > 0 ? project.gallery : [project.image];
            let currentImageIndex = 0;
            
            modalBody.innerHTML = `
                <div class="modal-header">
                    <div class="portfolio-category">${getCategoryName(project.category)}</div>
                    <h2 class="modal-title">${project.title}</h2>
                    <p class="modal-subtitle">${project.client} ‚Ä¢ ${project.year}</p>
                </div>
                
                <div class="modal-gallery">
                    <div class="gallery-main">
                        <img id="modal-main-image" 
                             src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iMjAiIGZpbGw9IiM5Q0EzQUYiLz4KPHA+Q2FyZ2FuZG8uLi48L3A+Cjwvc3ZnPg=="
                             data-src="${galleryImages[0]}" 
                             alt="${project.title}" 
                             class="lazy-image modal-image"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNzUgMTIwSDIyNVYxODBIMTc1VjEyMFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHA+SW1hZ2VuIG5vIGRpc3BvbmlibGU8L3A+Cjwvc3ZnPg==';">
                        ${galleryImages.length > 1 ? `
                            <button class="gallery-nav gallery-prev" onclick="changeGalleryImage(-1)" aria-label="Imagen anterior">‚Äπ</button>
                            <button class="gallery-nav gallery-next" onclick="changeGalleryImage(1)" aria-label="Imagen siguiente">‚Ä∫</button>
                        ` : ''}
                    </div>
                    ${galleryImages.length > 1 ? `
                        <div class="gallery-thumbnails">
                            ${galleryImages.map((img, index) => `
                                <img class="gallery-thumb ${index === 0 ? 'active' : ''}" 
                                     src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9IjQwIiBjeT0iMzAiIHI9IjgiIGZpbGw9IiM5Q0EzQUYiLz4KPC9zdmc+"
                                     data-src="${img}" 
                                     alt="Vista ${index + 1}" 
                                     class="lazy-image"
                                     onclick="setGalleryImage(${index})"
                                     onerror="this.style.display='none';">
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
                
                <div class="modal-content-grid">
                    <div class="modal-main-content">
                        <div class="project-description">
                            <h3>Descripci√≥n del Proyecto</h3>
                            <p>${project.description}</p>
                        </div>
                        
                        <div class="project-features">
                            <h3>Caracter√≠sticas Principales</h3>
                            <ul class="features-list">
                                ${project.features.map(feature => `
                                    <li class="feature-item">
                                        <span class="feature-icon">‚úì</span>
                                        <span class="feature-text">${feature}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                        
                        ${project.testimonial ? `
                            <div class="project-testimonial">
                                <h3>Testimonio del Cliente</h3>
                                <blockquote class="testimonial-quote enhanced">
                                    <div class="testimonial-stars">
                                        <span class="star">‚≠ê</span>
                                        <span class="star">‚≠ê</span>
                                        <span class="star">‚≠ê</span>
                                        <span class="star">‚≠ê</span>
                                        <span class="star">‚≠ê</span>
                                    </div>
                                    <p>"${project.testimonial.text}"</p>
                                    <footer class="testimonial-author">
                                        <div class="author-info">
                                            <strong>${project.testimonial.author}</strong>
                                            <span>${project.testimonial.position}</span>
                                        </div>
                                        <div class="testimonial-date">
                                            <small>Proyecto completado en ${project.year}</small>
                                        </div>
                                    </footer>
                                </blockquote>
                                <div class="testimonial-metrics">
                                    <div class="metric">
                                        <span class="metric-value">100%</span>
                                        <span class="metric-label">Satisfacci√≥n</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-value">${project.duration}</span>
                                        <span class="metric-label">Duraci√≥n</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-value">5‚òÖ</span>
                                        <span class="metric-label">Calificaci√≥n</span>
                                    </div>
                                </div>
                            </div>
                        ` : `
                            <div class="project-testimonial">
                                <h3>Proyecto Destacado</h3>
                                <div class="no-testimonial">
                                    <p>Este proyecto forma parte de nuestro portafolio de casos de √©xito. Cada proyecto es desarrollado con los m√°s altos est√°ndares de calidad y atenci√≥n al detalle.</p>
                                    <div class="project-highlights">
                                        <div class="highlight">
                                            <span class="highlight-icon">‚ú®</span>
                                            <span>Desarrollo profesional</span>
                                        </div>
                                        <div class="highlight">
                                            <span class="highlight-icon">üöÄ</span>
                                            <span>Entrega a tiempo</span>
                                        </div>
                                        <div class="highlight">
                                            <span class="highlight-icon">üíØ</span>
                                            <span>Calidad garantizada</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `}
                    </div>
                    
                    <div class="modal-sidebar">
                        <div class="project-details">
                            <h3>Detalles del Proyecto</h3>
                            <div class="detail-item">
                                <span class="detail-label">Duraci√≥n:</span>
                                <span class="detail-value">${project.duration}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Cliente:</span>
                                <span class="detail-value">${project.client}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">A√±o:</span>
                                <span class="detail-value">${project.year}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Categor√≠a:</span>
                                <span class="detail-value">${getCategoryName(project.category)}</span>
                            </div>
                        </div>
                        
                        <div class="project-technologies">
                            <h3>Tecnolog√≠as Utilizadas</h3>
                            <div class="tech-tags">
                                ${project.technologies.map(tech => `<span class="tech-tag">${tech}</span>`).join('')}
                            </div>
                        </div>
                        
                        <div class="project-actions">
                            <h3>Acciones</h3>
                            <div class="action-buttons">
                                ${project.liveUrl ? `
                                    <a href="${project.liveUrl}" target="_blank" class="btn btn--primary btn--full" rel="noopener noreferrer">
                                        <span>üåê</span> Ver Sitio Web
                                    </a>
                                ` : ''}
                                ${project.githubUrl ? `
                                    <a href="${project.githubUrl}" target="_blank" class="btn btn--outline btn--full" rel="noopener noreferrer">
                                        <span>üíª</span> Ver C√≥digo
                                    </a>
                                ` : ''}
                                <a href="contacto.html?servicio=${project.category}" class="btn btn--outline btn--full">
                                    <span>üí¨</span> Proyecto Similar
                                </a>
                                <button onclick="shareProject('${project.title}', '${project.liveUrl || ''}')" class="btn btn--secondary btn--full">
                                    <span>üì§</span> Compartir Proyecto
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Configurar funciones de galer√≠a
            window.currentGalleryImages = galleryImages;
            window.currentImageIndex = 0;
            
            // Mostrar modal con animaci√≥n
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Inicializar lazy loading para im√°genes del modal
            setTimeout(() => {
                initModalLazyLoading();
            }, 100);
            
            // Enfocar el modal para accesibilidad
            modal.focus();
        }
        
        // Funci√≥n para cambiar imagen de la galer√≠a
        window.changeGalleryImage = function(direction) {
            const images = window.currentGalleryImages;
            if (!images || images.length <= 1) return;
            
            window.currentImageIndex = (window.currentImageIndex + direction + images.length) % images.length;
            setGalleryImage(window.currentImageIndex);
        }
        
        // Funci√≥n para establecer imagen espec√≠fica
        window.setGalleryImage = function(index) {
            const images = window.currentGalleryImages;
            if (!images || index < 0 || index >= images.length) return;
            
            window.currentImageIndex = index;
            
            const mainImage = document.getElementById('modal-main-image');
            const thumbnails = document.querySelectorAll('.gallery-thumb');
            
            if (mainImage) {
                mainImage.style.opacity = '0';
                
                // Precargar imagen antes de mostrarla
                const newImg = new Image();
                newImg.onload = () => {
                    setTimeout(() => {
                        mainImage.src = images[index];
                        mainImage.classList.add('loaded');
                        mainImage.style.opacity = '1';
                    }, 150);
                };
                newImg.onerror = () => {
                    setTimeout(() => {
                        mainImage.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNzUgMTIwSDIyNVYxODBIMTc1VjEyMFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHA+SW1hZ2VuIG5vIGRpc3BvbmlibGU8L3A+Cjwvc3ZnPg==';
                        mainImage.style.opacity = '1';
                    }, 150);
                };
                newImg.src = images[index];
            }
            
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
                
                // Cargar thumbnail si no est√° cargado
                if (i === index && thumb.hasAttribute('data-src')) {
                    const thumbSrc = thumb.getAttribute('data-src');
                    const thumbImg = new Image();
                    thumbImg.onload = () => {
                        thumb.src = thumbSrc;
                        thumb.classList.add('loaded');
                        thumb.removeAttribute('data-src');
                    };
                    thumbImg.src = thumbSrc;
                }
            });
        }
        
        // Funci√≥n para compartir proyecto
        window.shareProject = function(title, url) {
            if (navigator.share) {
                navigator.share({
                    title: `Proyecto: ${title} - tuweb`,
                    text: `Mira este incre√≠ble proyecto de desarrollo web: ${title}`,
                    url: url || window.location.href
                }).catch(console.error);
            } else {
                // Fallback: copiar al portapapeles
                const shareText = `Mira este incre√≠ble proyecto: ${title} - ${url || window.location.href}`;
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('¬°Enlace copiado al portapapeles!');
                }).catch(() => {
                    alert('No se pudo copiar el enlace. Comparte manualmente: ' + shareText);
                });
            }
        }
        
        // Funci√≥n para cerrar modal
        function closeModal() {
            const modal = document.getElementById('portfolio-modal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            
            // Limpiar variables globales
            window.currentGalleryImages = null;
            window.currentImageIndex = 0;
        }
        
        // Cerrar modal
        document.getElementById('modal-close').addEventListener('click', closeModal);
        
        // Cerrar modal al hacer clic fuera
        document.getElementById('portfolio-modal').addEventListener('click', (e) => {
            if (e.target.id === 'portfolio-modal') {
                closeModal();
            }
        });
        
        // Cerrar modal con tecla Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const modal = document.getElementById('portfolio-modal');
                if (modal.classList.contains('active')) {
                    closeModal();
                }
            }
        });
        
        // Navegaci√≥n de galer√≠a con teclado
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('portfolio-modal');
            if (!modal.classList.contains('active')) return;
            
            if (e.key === 'ArrowLeft') {
                e.preventDefault();
                changeGalleryImage(-1);
            } else if (e.key === 'ArrowRight') {
                e.preventDefault();
                changeGalleryImage(1);
            }
        });
        
        // Funci√≥n para inicializar lazy loading en el modal
        function initModalLazyLoading() {
            const modalImages = document.querySelectorAll('.modal .lazy-image');
            
            modalImages.forEach(img => {
                const src = img.getAttribute('data-src');
                if (src) {
                    const newImg = new Image();
                    newImg.onload = () => {
                        img.src = src;
                        img.classList.add('loaded');
                        img.removeAttribute('data-src');
                    };
                    newImg.onerror = () => {
                        img.classList.add('error');
                    };
                    newImg.src = src;
                }
            });
        }
        
        // Cargar portafolio al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', loadPortfolio);
    </script>

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "Portafolio tuweb",
        "description": "Colecci√≥n de proyectos y casos de √©xito de tuweb en desarrollo web",
        "url": "https://tuweb.pe/portafolio.html",
        "mainEntity": {
            "@type": "ItemList",
            "name": "Proyectos de Desarrollo Web",
            "description": "Proyectos destacados realizados por tuweb",
            "numberOfItems": 8,
            "itemListElement": [
                {
                    "@type": "CreativeWork",
                    "name": "E-commerce Moda Peruana",
                    "description": "Tienda online completa con carrito de compras y pasarela de pagos",
                    "creator": {
                        "@type": "Organization",
                        "name": "tuweb"
                    },
                    "dateCreated": "2024"
                },
                {
                    "@type": "CreativeWork",
                    "name": "Restaurante Sabores del Norte",
                    "description": "Sitio web corporativo con sistema de reservas online",
                    "creator": {
                        "@type": "Organization",
                        "name": "tuweb"
                    },
                    "dateCreated": "2024"
                }
            ]
        }
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "tuweb",
        "hasCredential": {
            "@type": "EducationalOccupationalCredential",
            "name": "Portafolio de Desarrollo Web",
            "description": "M√°s de 100 proyectos completados exitosamente",
            "credentialCategory": "Professional Portfolio"
        },
        "knowsAbout": [
            "Web Development",
            "E-commerce Development",
            "Responsive Design",
            "SEO Optimization",
            "Web Applications"
        ]
    }
    </script>
</body>
</html>